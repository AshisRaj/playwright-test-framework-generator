import { expect, test } from '@fixtures';

let userId: number;

test('Create user', { tag: ['@smoke', '@regression'] }, async ({ api }) => {
  const response = await api.request.post('/users', {
    data: {
      name: 'Ashis Raj',
      email: 'ashis@example.com',
    },
  });

  expect(response.status()).toBe(201);
  const body = await response.json();

  userId = body.id;
  expect(body.name).toBe('Ashis Raj');
});

test('Get all users', { tag: ['@smoke', '@regression'] }, async ({ api }) => {
  const response = await api.request.get('/users');
  expect(response.status()).toBe(200);

  const users = await response.json();
  expect(users.length).toBeGreaterThan(0);
});

test('Get user by ID', { tag: ['@smoke', '@regression'] }, async ({ api }) => {
  const response = await api.request.get(`/users/${userId}`);
  expect(response.status()).toBe(200);
});

test('Delete user', { tag: ['@smoke', '@regression'] }, async ({ api }) => {
  const response = await api.request.delete(`/users/${userId}`);
  expect(response.status()).toBe(200);
});
